local lib = {
    RainbowColorValue = 0,
    HueSelectionPosition = 0
}

-- Services
local UserInputService = game:GetService("UserInputService")
local TweenService = game:GetService("TweenService")
local RunService = game:GetService("RunService")
local Players = game:GetService("Players")
local CoreGui = game:GetService("CoreGui")

-- Variables
local LocalPlayer = Players.LocalPlayer
local Mouse = LocalPlayer:GetMouse()
local PresetColor = Color3.fromRGB(44, 120, 224)
local CloseBind = Enum.KeyCode.RightControl

-- Main UI Container
local ui = Instance.new("ScreenGui")
ui.Name = "OptimizedUI"
ui.Parent = CoreGui
ui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling

-- Rainbow color animation
coroutine.wrap(function()
    while RunService.Heartbeat:Wait() do
        lib.RainbowColorValue = (lib.RainbowColorValue + 1/255) % 1
        lib.HueSelectionPosition = (lib.HueSelectionPosition + 1) % 80
    end
end)()

-- Utility Functions
local function CreateInstance(className, properties)
    local instance = Instance.new(className)
    for property, value in pairs(properties) do
        instance[property] = value
    end
    return instance
end

local function TweenCreate(instance, tweenInfo, properties)
    return TweenService:Create(instance, tweenInfo, properties)
end

local function MakeDraggable(topbarobject, object)
    local Dragging, DragInput, DragStart, StartPosition

    local function Update(input)
        local Delta = input.Position - DragStart
        local pos = UDim2.new(
            StartPosition.X.Scale,
            StartPosition.X.Offset + Delta.X,
            StartPosition.Y.Scale,
            StartPosition.Y.Offset + Delta.Y
        )
        object.Position = pos
    end

    topbarobject.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
            Dragging = true
            DragStart = input.Position
            StartPosition = object.Position

            input.Changed:Connect(function()
                if input.UserInputState == Enum.UserInputState.End then
                    Dragging = false
                end
            end)
        end
    end)

    topbarobject.InputChanged:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch then
            DragInput = input
        end
    end)

    UserInputService.InputChanged:Connect(function(input)
        if input == DragInput and Dragging then
            Update(input)
        end
    end)
end

-- Main Library Functions
function lib:Window(text, preset, closebind)
    CloseBind = closebind or CloseBind
    PresetColor = preset or PresetColor
    local fs = false
    
    -- Main Window Frame
    local Main = CreateInstance("Frame", {
        Name = "Main",
        Parent = ui,
        AnchorPoint = Vector2.new(0.5, 0.5),
        BackgroundColor3 = Color3.fromRGB(30, 30, 30),
        BorderSizePixel = 0,
        Position = UDim2.new(0.5, 0, 0.5, 0),
        Size = UDim2.new(0, 0, 0, 0),
        ClipsDescendants = true,
        Visible = true
    })

    -- Tab Holder with Scrolling
    local TabHold = CreateInstance("ScrollingFrame", {
        Name = "TabHold",
        Parent = Main,
        BackgroundTransparency = 1,
        Position = UDim2.new(0.034, 0, 0.147, 0),
        Size = UDim2.new(0, 107, 0, 254),
        CanvasSize = UDim2.new(0, 0, 0, 0),
        ScrollBarThickness = 3,
        ScrollBarImageColor3 = Color3.fromRGB(60, 60, 60),
        ClipsDescendants = true
    })

    local TabHoldLayout = CreateInstance("UIListLayout", {
        Parent = TabHold,
        SortOrder = Enum.SortOrder.LayoutOrder,
        Padding = UDim.new(0, 11)
    })

    -- Update TabHolder canvas size when layout changes
    TabHoldLayout:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(function()
        TabHold.CanvasSize = UDim2.new(0, 0, 0, TabHoldLayout.AbsoluteContentSize.Y)
    end)

    -- Title
    local Title = CreateInstance("TextLabel", {
        Name = "Title",
        Parent = Main,
        BackgroundTransparency = 1,
        Position = UDim2.new(0.034, 0, 0.056, 0),
        Size = UDim2.new(0, 200, 0, 23),
        Font = Enum.Font.GothamSemibold,
        Text = text,
        TextColor3 = Color3.fromRGB(68, 68, 68),
        TextSize = 12,
        TextXAlignment = Enum.TextXAlignment.Left
    })

    -- Drag Frame
    local DragFrame = CreateInstance("Frame", {
        Name = "DragFrame",
        Parent = Main,
        BackgroundTransparency = 1,
        Size = UDim2.new(0, 560, 0, 41)
    })

    -- Tab Folder
    local TabFolder = CreateInstance("Folder", {
        Name = "TabFolder",
        Parent = Main
    })

    -- Animate window opening
    Main:TweenSize(UDim2.new(0, 560, 0, 319), Enum.EasingDirection.Out, Enum.EasingStyle.Quart, 0.6, true)
    MakeDraggable(DragFrame, Main)

    -- Toggle UI visibility
    local uitoggled = false
    UserInputService.InputBegan:Connect(function(input, processed)
        if not processed and input.KeyCode == CloseBind then
            uitoggled = not uitoggled
            
            if uitoggled then
                Main:TweenSize(UDim2.new(0, 0, 0, 0), Enum.EasingDirection.Out, Enum.EasingStyle.Quart, 0.6, true, function()
                    ui.Enabled = false
                end)
            else
                ui.Enabled = true
                Main:TweenSize(UDim2.new(0, 560, 0, 319), Enum.EasingDirection.Out, Enum.EasingStyle.Quart, 0.6, true)
            end
        end
    end)

    -- Change preset color function
    function lib:ChangePresetColor(newColor)
        PresetColor = newColor
    end

    local tabhold = {}
    
    function tabhold:Tab(text)
        -- Tab Button
        local TabBtn = CreateInstance("TextButton", {
            Name = "TabBtn",
            Parent = TabHold,
            BackgroundTransparency = 1,
            Size = UDim2.new(0, 107, 0, 21),
            Font = Enum.Font.SourceSans,
            Text = "",
            TextColor3 = Color3.fromRGB(0, 0, 0),
            TextSize = 14
        })

        local TabTitle = CreateInstance("TextLabel", {
            Name = "TabTitle",
            Parent = TabBtn,
            BackgroundTransparency = 1,
            Size = UDim2.new(0, 107, 0, 21),
            Font = Enum.Font.Gotham,
            Text = text,
            TextColor3 = Color3.fromRGB(150, 150, 150),
            TextSize = 14,
            TextXAlignment = Enum.TextXAlignment.Left
        })

        local TabBtnIndicator = CreateInstance("Frame", {
            Name = "TabBtnIndicator",
            Parent = TabBtn,
            BackgroundColor3 = PresetColor,
            BorderSizePixel = 0,
            Position = UDim2.new(0, 0, 1, 0),
            Size = UDim2.new(0, 0, 0, 2)
        })

        CreateInstance("UICorner", {Parent = TabBtnIndicator})

        -- Preset color sync
        coroutine.wrap(function()
            while RunService.Heartbeat:Wait() do
                TabBtnIndicator.BackgroundColor3 = PresetColor
            end
        end)()

        -- Tab Content
        local Tab = CreateInstance("ScrollingFrame", {
            Name = "Tab",
            Parent = TabFolder,
            Active = true,
            BackgroundTransparency = 1,
            BorderSizePixel = 0,
            Position = UDim2.new(0.314, 0, 0.147, 0),
            Size = UDim2.new(0, 373, 0, 254),
            CanvasSize = UDim2.new(0, 0, 0, 0),
            ScrollBarThickness = 3,
            ScrollBarImageColor3 = Color3.fromRGB(60, 60, 60),
            Visible = false
        })

        local TabLayout = CreateInstance("UIListLayout", {
            Parent = Tab,
            SortOrder = Enum.SortOrder.LayoutOrder,
            Padding = UDim.new(0, 6)
        })

        -- Update Tab canvas size when layout changes
        TabLayout:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(function()
            Tab.CanvasSize = UDim2.new(0, 0, 0, TabLayout.AbsoluteContentSize.Y)
        end)

        -- Set first tab as active
        if not fs then
            fs = true
            TabBtnIndicator.Size = UDim2.new(0, 13, 0, 2)
            TabTitle.TextColor3 = Color3.fromRGB(255, 255, 255)
            Tab.Visible = true
        end

        -- Tab switching logic
        TabBtn.MouseButton1Click:Connect(function()
            for _, v in pairs(TabFolder:GetChildren()) do
                if v.Name == "Tab" then
                    v.Visible = false
                end
            end
            Tab.Visible = true
            
            for _, v in pairs(TabHold:GetChildren()) do
                if v.Name == "TabBtn" then
                    v.TabBtnIndicator:TweenSize(UDim2.new(0, 0, 0, 2), Enum.EasingDirection.Out, Enum.EasingStyle.Quart, 0.2, true)
                    TweenCreate(v.TabTitle, TweenInfo.new(0.3, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), {
                        TextColor3 = Color3.fromRGB(150, 150, 150)
                    }):Play()
                end
            end
            
            TabBtnIndicator:TweenSize(UDim2.new(0, 13, 0, 2), Enum.EasingDirection.Out, Enum.EasingStyle.Quart, 0.2, true)
            TweenCreate(TabTitle, TweenInfo.new(0.3, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), {
                TextColor3 = Color3.fromRGB(255, 255, 255)
            }):Play()
        end)

        local tabcontent = {}
        
        function tabcontent:Button(text, callback)
            local Button = CreateInstance("TextButton", {
                Name = "Button",
                Parent = Tab,
                BackgroundColor3 = Color3.fromRGB(34, 34, 34),
                Size = UDim2.new(0, 363, 0, 42),
                AutoButtonColor = false,
                Font = Enum.Font.SourceSans,
                Text = "",
                TextColor3 = Color3.fromRGB(0, 0, 0),
                TextSize = 14
            })

            CreateInstance("UICorner", {
                Parent = Button,
                CornerRadius = UDim.new(0, 5)
            })

            local ButtonTitle = CreateInstance("TextLabel", {
                Name = "ButtonTitle",
                Parent = Button,
                BackgroundTransparency = 1,
                Position = UDim2.new(0.036, 0, 0, 0),
                Size = UDim2.new(0, 187, 0, 42),
                Font = Enum.Font.Gotham,
                Text = text,
                TextColor3 = Color3.fromRGB(255, 255, 255),
                TextSize = 14,
                TextXAlignment = Enum.TextXAlignment.Left
            })

            -- Hover effects
            Button.MouseEnter:Connect(function()
                TweenCreate(Button, TweenInfo.new(0.3, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), {
                    BackgroundColor3 = Color3.fromRGB(37, 37, 37)
                }):Play()
            end)

            Button.MouseLeave:Connect(function()
                TweenCreate(Button, TweenInfo.new(0.2, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), {
                    BackgroundColor3 = Color3.fromRGB(34, 34, 34)
                }):Play()
            end)

            Button.MouseButton1Click:Connect(function()
                pcall(callback)
            end)
        end

        function tabcontent:Toggle(text, default, callback)
            local toggled = false

            local Toggle = CreateInstance("TextButton", {
                Name = "Toggle",
                Parent = Tab,
                BackgroundColor3 = Color3.fromRGB(34, 34, 34),
                Size = UDim2.new(0, 363, 0, 42),
                AutoButtonColor = false,
                Font = Enum.Font.SourceSans,
                Text = "",
                TextColor3 = Color3.fromRGB(0, 0, 0),
                TextSize = 14
            })

            CreateInstance("UICorner", {
                Parent = Toggle,
                CornerRadius = UDim.new(0, 5)
            })

            local ToggleTitle = CreateInstance("TextLabel", {
                Name = "ToggleTitle",
                Parent = Toggle,
                BackgroundTransparency = 1,
                Position = UDim2.new(0.036, 0, 0, 0),
                Size = UDim2.new(0, 187, 0, 42),
                Font = Enum.Font.Gotham,
                Text = text,
                TextColor3 = Color3.fromRGB(255, 255, 255),
                TextSize = 14,
                TextXAlignment = Enum.TextXAlignment.Left
            })

            -- Toggle Components
            local FrameToggle1 = CreateInstance("Frame", {
                Name = "FrameToggle1",
                Parent = Toggle,
                BackgroundColor3 = Color3.fromRGB(50, 50, 50),
                Position = UDim2.new(0.86, 0, 0.286, 0),
                Size = UDim2.new(0, 37, 0, 18)
            })
            CreateInstance("UICorner", {Parent = FrameToggle1})

            local FrameToggle2 = CreateInstance("Frame", {
                Name = "FrameToggle2",
                Parent = FrameToggle1,
                BackgroundColor3 = Color3.fromRGB(34, 34, 34),
                Position = UDim2.new(0.049, 0, 0.093, 0),
                Size = UDim2.new(0, 33, 0, 14)
            })
            CreateInstance("UICorner", {Parent = FrameToggle2})

            local FrameToggle3 = CreateInstance("Frame", {
                Name = "FrameToggle3",
                Parent = FrameToggle1,
                BackgroundColor3 = PresetColor,
                BackgroundTransparency = 1,
                Size = UDim2.new(0, 37, 0, 18)
            })
            CreateInstance("UICorner", {Parent = FrameToggle3})

            local FrameToggleCircle = CreateInstance("Frame", {
                Name = "FrameToggleCircle",
                Parent = FrameToggle1,
                BackgroundColor3 = Color3.fromRGB(50, 50, 50),
                Position = UDim2.new(0.127, 0, 0.222, 0),
                Size = UDim2.new(0, 10, 0, 10)
            })
            CreateInstance("UICorner", {Parent = FrameToggleCircle})

            -- Preset color sync
            coroutine.wrap(function()
                while RunService.Heartbeat:Wait() do
                    FrameToggle3.BackgroundColor3 = PresetColor
                end
            end)()

            local function UpdateToggleState()
                if toggled then
                    TweenCreate(Toggle, TweenInfo.new(0.3, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), {
                        BackgroundColor3 = Color3.fromRGB(37, 37, 37)
                    }):Play()
                    TweenCreate(FrameToggle1, TweenInfo.new(0.3, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), {
                        BackgroundTransparency = 1
                    }):Play()
                    TweenCreate(FrameToggle2, TweenInfo.new(0.3, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), {
                        BackgroundTransparency = 1
                    }):Play()
                    TweenCreate(FrameToggle3, TweenInfo.new(0.3, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), {
                        BackgroundTransparency = 0
                    }):Play()
                    TweenCreate(FrameToggleCircle, TweenInfo.new(0.3, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), {
                        BackgroundColor3 = Color3.fromRGB(255, 255, 255)
                    }):Play()
                    FrameToggleCircle:TweenPosition(UDim2.new(0.587, 0, 0.222, 0), Enum.EasingDirection.Out, Enum.EasingStyle.Quart, 0.2, true)
                else
                    TweenCreate(Toggle, TweenInfo.new(0.3, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), {
                        BackgroundColor3 = Color3.fromRGB(34, 34, 34)
                    }):Play()
                    TweenCreate(FrameToggle1, TweenInfo.new(0.3, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), {
                        BackgroundTransparency = 0
                    }):Play()
                    TweenCreate(FrameToggle2, TweenInfo.new(0.3, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), {
                        BackgroundTransparency = 0
                    }):Play()
                    TweenCreate(FrameToggle3, TweenInfo.new(0.3, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), {
                        BackgroundTransparency = 1
                    }):Play()
                    TweenCreate(FrameToggleCircle, TweenInfo.new(0.3, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), {
                        BackgroundColor3 = Color3.fromRGB(50, 50, 50)
                    }):Play()
                    FrameToggleCircle:TweenPosition(UDim2.new(0.127, 0, 0.222, 0), Enum.EasingDirection.Out, Enum.EasingStyle.Quart, 0.2, true)
                end
                toggled = not toggled
                pcall(callback, toggled)
            end

            Toggle.MouseButton1Click:Connect(UpdateToggleState)

            -- Set default state
            if default then
                UpdateToggleState()
            end
        end

        function tabcontent:Slider(text, min, max, start, callback, options)
            local dragging = false
            start = start or min
            local options = options or {}
            local increment = options.increment or 1
            local precise = options.precise or false

            local Slider = CreateInstance("TextButton", {
                Name = "Slider",
                Parent = Tab,
                BackgroundColor3 = Color3.fromRGB(34, 34, 34),
                Size = UDim2.new(0, 363, 0, 60),
                AutoButtonColor = false,
                Font = Enum.Font.SourceSans,
                Text = "",
                TextColor3 = Color3.fromRGB(0, 0, 0),
                TextSize = 14
            })

            CreateInstance("UICorner", {
                Parent = Slider,
                CornerRadius = UDim.new(0, 5)
            })

            local SliderTitle = CreateInstance("TextLabel", {
                Name = "SliderTitle",
                Parent = Slider,
                BackgroundTransparency = 1,
                Position = UDim2.new(0.036, 0, 0, 0),
                Size = UDim2.new(0, 187, 0, 42),
                Font = Enum.Font.Gotham,
                Text = text,
                TextColor3 = Color3.fromRGB(255, 255, 255),
                TextSize = 14,
                TextXAlignment = Enum.TextXAlignment.Left
            })

            local SliderValue = CreateInstance("TextLabel", {
                Name = "SliderValue",
                Parent = Slider,
                BackgroundTransparency = 1,
                Position = UDim2.new(0.036, 0, 0, 0),
                Size = UDim2.new(0, 335, 0, 42),
                Font = Enum.Font.Gotham,
                Text = tostring(precise and start or math.floor(start)),
                TextColor3 = Color3.fromRGB(255, 255, 255),
                TextSize = 14,
                TextXAlignment = Enum.TextXAlignment.Right
            })

            local SlideFrame = CreateInstance("Frame", {
                Name = "SlideFrame",
                Parent = Slider,
                BackgroundColor3 = Color3.fromRGB(50, 50, 50),
                BorderSizePixel = 0,
                Position = UDim2.new(0.034, 0, 0.686, 0),
                Size = UDim2.new(0, 335, 0, 3)
            })

            local CurrentValueFrame = CreateInstance("Frame", {
                Name = "CurrentValueFrame",
                Parent = SlideFrame,
                BackgroundColor3 = PresetColor,
                BorderSizePixel = 0,
                Size = UDim2.new((start or 0) / max, 0, 0, 3)
            })

            local SlideCircle = CreateInstance("ImageButton", {
                Name = "SlideCircle",
                Parent = SlideFrame,
                BackgroundTransparency = 1,
                Position = UDim2.new((start or 0) / max, -6, -1.305, 0),
                Size = UDim2.new(0, 11, 0, 11),
                Image = "rbxassetid://3570695787",
                ImageColor3 = PresetColor
            })

            -- Increment buttons
            local DecrementBtn = CreateInstance("TextButton", {
                Name = "DecrementBtn",
                Parent = Slider,
                BackgroundColor3 = Color3.fromRGB(50, 50, 50),
                Position = UDim2.new(0.034, 0, 0.15, 0),
                Size = UDim2.new(0, 20, 0, 20),
                Font = Enum.Font.GothamBold,
                Text = "-",
                TextColor3 = Color3.fromRGB(200, 200, 200),
                TextSize = 14,
                AutoButtonColor = false
            })

            CreateInstance("UICorner", {
                Parent = DecrementBtn,
                CornerRadius = UDim.new(0, 4)
            })

            local IncrementBtn = CreateInstance("TextButton", {
                Name = "IncrementBtn",
                Parent = Slider,
                BackgroundColor3 = Color3.fromRGB(50, 50, 50),
                Position = UDim2.new(0.104, 0, 0.15, 0),
                Size = UDim2.new(0, 20, 0, 20),
                Font = Enum.Font.GothamBold,
                Text = "+",
                TextColor3 = Color3.fromRGB(200, 200, 200),
                TextSize = 14,
                AutoButtonColor = false
            })

            CreateInstance("UICorner", {
                Parent = IncrementBtn,
                CornerRadius = UDim.new(0, 4)
            })

            -- Preset color sync
            coroutine.wrap(function()
                while RunService.Heartbeat:Wait() do
                    CurrentValueFrame.BackgroundColor3 = PresetColor
                    SlideCircle.ImageColor3 = PresetColor
                end
            end)()

            local function updateSlider(value)
                value = math.clamp(value, min, max)
                local posX = value / max
                local pos = UDim2.new(posX, -6, -1.305, 0)
                local pos1 = UDim2.new(posX, 0, 0, 3)
                
                CurrentValueFrame:TweenSize(pos1, "Out", "Sine", 0.1, true)
                SlideCircle:TweenPosition(pos, "Out", "Sine", 0.1, true)
                
                local displayValue = precise and value or math.floor(value)
                SliderValue.Text = tostring(displayValue)
                pcall(callback, value)
            end

            local function move(input)
                local posX = math.clamp((input.Position.X - SlideFrame.AbsolutePosition.X) / SlideFrame.AbsoluteSize.X, 0, 1)
                local value = min + (posX * (max - min))
                
                -- Apply increment if specified
                if increment > 0 then
                    value = math.floor(value / increment) * increment
                end
                
                updateSlider(value)
            end

            -- Input handling
            local function beginDrag(input)
                if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
                    dragging = true
                    if input.UserInputType == Enum.UserInputType.Touch then
                        move(input)
                    end
                end
            end

            local function endDrag(input)
                if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
                    dragging = false
                end
            end

            SlideCircle.InputBegan:Connect(beginDrag)
            SlideCircle.InputEnded:Connect(endDrag)
            SlideFrame.InputBegan:Connect(beginDrag)
            SlideFrame.InputEnded:Connect(endDrag)

            UserInputService.InputChanged:Connect(function(input)
                if dragging and (input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch) then
                    move(input)
                end
            end)

            -- Increment/Decrement button functionality
            local function changeValue(amount)
                local currentValue = tonumber(SliderValue.Text) or start
                local newValue = math.clamp(currentValue + amount, min, max)
                
                -- Apply increment if specified
                if increment > 0 then
                    newValue = math.floor(newValue / increment) * increment
                end
                
                updateSlider(newValue)
            end

            DecrementBtn.MouseButton1Click:Connect(function()
                changeValue(-increment)
            end)

            IncrementBtn.MouseButton1Click:Connect(function()
                changeValue(increment)
            end)

            -- Hover effects for buttons
            local function setupButtonHover(button)
                button.MouseEnter:Connect(function()
                    TweenCreate(button, TweenInfo.new(0.2, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), {
                        BackgroundColor3 = Color3.fromRGB(60, 60, 60)
                    }):Play()
                end)

                button.MouseLeave:Connect(function()
                    TweenCreate(button, TweenInfo.new(0.2, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), {
                        BackgroundColor3 = Color3.fromRGB(50, 50, 50)
                    }):Play()
                end)
            end

            setupButtonHover(DecrementBtn)
            setupButtonHover(IncrementBtn)

            -- Set initial value
            updateSlider(start)
        end

        function tabcontent:Dropdown(text, list, callback)
            local droptog = false
            local framesize = 0
            local itemcount = 0

            local Dropdown = CreateInstance("Frame", {
                Name = "Dropdown",
                Parent = Tab,
                BackgroundColor3 = Color3.fromRGB(34, 34, 34),
                ClipsDescendants = true,
                Size = UDim2.new(0, 363, 0, 42)
            })

            CreateInstance("UICorner", {
                Parent = Dropdown,
                CornerRadius = UDim.new(0, 5)
            })

            local DropdownBtn = CreateInstance("TextButton", {
                Name = "DropdownBtn",
                Parent = Dropdown,
                BackgroundTransparency = 1,
                Size = UDim2.new(0, 363, 0, 42),
                Font = Enum.Font.SourceSans,
                Text = "",
                TextColor3 = Color3.fromRGB(0, 0, 0),
                TextSize = 14
            })

            local DropdownTitle = CreateInstance("TextLabel", {
                Name = "DropdownTitle",
                Parent = Dropdown,
                BackgroundTransparency = 1,
                Position = UDim2.new(0.036, 0, 0, 0),
                Size = UDim2.new(0, 187, 0, 42),
                Font = Enum.Font.Gotham,
                Text = text,
                TextColor3 = Color3.fromRGB(255, 255, 255),
                TextSize = 14,
                TextXAlignment = Enum.TextXAlignment.Left
            })

            local ArrowImg = CreateInstance("ImageLabel", {
                Name = "ArrowImg",
                Parent = DropdownTitle,
                BackgroundTransparency = 1,
                Position = UDim2.new(1.652, 0, 0.19, 0),
                Size = UDim2.new(0, 26, 0, 26),
                Image = "http://www.roblox.com/asset/?id=6034818375"
            })

            local DropItemHolder = CreateInstance("ScrollingFrame", {
                Name = "DropItemHolder",
                Parent = DropdownTitle,
                Active = true,
                BackgroundTransparency = 1,
                BorderSizePixel = 0,
                Position = UDim2.new(-0.004, 0, 1.05, 0),
                Size = UDim2.new(0, 342, 0, 0),
                CanvasSize = UDim2.new(0, 0, 0, 0),
                ScrollBarThickness = 3,
                ScrollBarImageColor3 = Color3.fromRGB(60, 60, 60)
            })

            local DropLayout = CreateInstance("UIListLayout", {
                Parent = DropItemHolder,
                SortOrder = Enum.SortOrder.LayoutOrder
            })

            DropdownBtn.MouseButton1Click:Connect(function()
                droptog = not droptog
                
                if droptog then
                    Dropdown:TweenSize(UDim2.new(0, 363, 0, 55 + framesize), Enum.EasingDirection.Out, Enum.EasingStyle.Quart, 0.2, true)
                    TweenCreate(ArrowImg, TweenInfo.new(0.3, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), {
                        Rotation = 270
                    }):Play()
                else
                    Dropdown:TweenSize(UDim2.new(0, 363, 0, 42), Enum.EasingDirection.Out, Enum.EasingStyle.Quart, 0.2, true)
                    TweenCreate(ArrowImg, TweenInfo.new(0.3, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), {
                        Rotation = 0
                    }):Play()
                end
            end)

            -- Create dropdown items
            for _, v in pairs(list) do
                itemcount = itemcount + 1
                if itemcount <= 3 then
                    framesize = framesize + 26
                    DropItemHolder.Size = UDim2.new(0, 342, 0, framesize)
                end

                local Item = CreateInstance("TextButton", {
                    Name = "Item",
                    Parent = DropItemHolder,
                    BackgroundColor3 = Color3.fromRGB(34, 34, 34),
                    ClipsDescendants = true,
                    Size = UDim2.new(0, 335, 0, 25),
                    AutoButtonColor = false,
                    Font = Enum.Font.Gotham,
                    Text = v,
                    TextColor3 = Color3.fromRGB(255, 255, 255),
                    TextSize = 15
                })

                CreateInstance("UICorner", {
                    Parent = Item,
                    CornerRadius = UDim.new(0, 4)
                })

                -- Hover effects
                Item.MouseEnter:Connect(function()
                    TweenCreate(Item, TweenInfo.new(0.3, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), {
                        BackgroundColor3 = Color3.fromRGB(37, 37, 37)
                    }):Play()
                end)

                Item.MouseLeave:Connect(function()
                    TweenCreate(Item, TweenInfo.new(0.3, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), {
                        BackgroundColor3 = Color3.fromRGB(34, 34, 34)
                    }):Play()
                end)

                Item.MouseButton1Click:Connect(function()
                    droptog = false
                    DropdownTitle.Text = text .. " - " .. v
                    pcall(callback, v)
                    Dropdown:TweenSize(UDim2.new(0, 363, 0, 42), Enum.EasingDirection.Out, Enum.EasingStyle.Quart, 0.2, true)
                    TweenCreate(ArrowImg, TweenInfo.new(0.3, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), {
                        Rotation = 0
                    }):Play()
                end)

                DropItemHolder.CanvasSize = UDim2.new(0, 0, 0, DropLayout.AbsoluteContentSize.Y)
            end
        end

        function tabcontent:Textbox(text, disappear, callback)
            local Textbox = CreateInstance("Frame", {
                Name = "Textbox",
                Parent = Tab,
                BackgroundColor3 = Color3.fromRGB(34, 34, 34),
                ClipsDescendants = true,
                Size = UDim2.new(0, 363, 0, 42)
            })

            CreateInstance("UICorner", {
                Parent = Textbox,
                CornerRadius = UDim.new(0, 5)
            })

            local TextboxTitle = CreateInstance("TextLabel", {
                Name = "TextboxTitle",
                Parent = Textbox,
                BackgroundTransparency = 1,
                Position = UDim2.new(0.036, 0, 0, 0),
                Size = UDim2.new(0, 187, 0, 42),
                Font = Enum.Font.Gotham,
                Text = text,
                TextColor3 = Color3.fromRGB(255, 255, 255),
                TextSize = 14,
                TextXAlignment = Enum.TextXAlignment.Left
            })

            local TextboxFrame = CreateInstance("Frame", {
                Name = "TextboxFrame",
                Parent = TextboxTitle,
                BackgroundColor3 = Color3.fromRGB(37, 37, 37),
                Position = UDim2.new(1.289, 0, 0.214, 0),
                Size = UDim2.new(0, 100, 0, 23)
            })

            CreateInstance("UICorner", {
                Parent = TextboxFrame,
                CornerRadius = UDim.new(0, 5)
            })

            local TextBox = CreateInstance("TextBox", {
                Parent = TextboxFrame,
                BackgroundTransparency = 1,
                Size = UDim2.new(0, 100, 0, 23),
                Font = Enum.Font.Gotham,
                Text = "",
                TextColor3 = Color3.fromRGB(255, 255, 255),
                TextSize = 14
            })

            TextBox.FocusLost:Connect(function(enterPressed)
                if enterPressed and #TextBox.Text > 0 then
                    pcall(callback, TextBox.Text)
                    if disappear then
                        TextBox.Text = ""
                    end
                end
            end)
        end

        return tabcontent
    end
    
    return tabhold
end

return lib