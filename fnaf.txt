local Workspace = game:GetService("Workspace")

local Library = loadstring(game:HttpGet("https://raw.githubusercontent.com/iaineverseen/files/refs/heads/main/Sentinel.txt"))()

local ESPStore = {
    Highlights = {},
    NameTags = {},
    Enabled = {}
}

local FNAF_ESP_CONFIG = {
    Freddy = {Path = {"Animatronics", "Freddy", "FreddyNPC"}, Color = Color3.fromRGB(139, 69, 19), Type = "FNAF1"},
    Bonnie = {Path = {"Animatronics", "Bonnie", "BonnieNPC"}, Color = Color3.new(0, 0, 1), Type = "FNAF1"},
    Chica = {Path = {"Animatronics", "Chica", "ChicaNPC"}, Color = Color3.new(1, 1, 0), Type = "FNAF1"},
    Foxy = {Path = {"Animatronics", "Foxy", "FoxyNPC"}, Color = Color3.new(1, 0, 0), Type = "FNAF1"},
    
    ["Withered Freddy"] = {Path = {"Animatronics", "Freddy", "FreddyNPC"}, Color = Color3.new(0.3, 0.2, 0.1), Type = "Withered"},
    ["Withered Bonnie"] = {Path = {"Animatronics", "Bonnie", "BonnieNPC"}, Color = Color3.new(0, 0, 0.4), Type = "Withered"},
    ["Withered Chica"] = {Path = {"Animatronics", "Chica", "ChicaNPC"}, Color = Color3.new(0.8, 0.5, 0.1), Type = "Withered"},
    ["Withered Foxy"] = {Path = {"Animatronics", "Foxy", "FoxyNPC"}, Color = Color3.new(0.5, 0, 0), Type = "Withered"},
    
    ["Toy Freddy"] = {Path = {"Animatronics", "ToyFreddy", "ToyFreddyNPC"}, Color = Color3.new(0.4, 0.3, 0.2), Type = "Toy"},
    ["Toy Bonnie"] = {Path = {"Animatronics", "ToyBonnie", "ToyBonnieNPC"}, Color = Color3.new(0.1, 0.7, 1), Type = "Toy"},
    ["Toy Chica"] = {Path = {"Animatronics", "ToyChica", "ToyChicaNPC"}, Color = Color3.new(1, 1, 0), Type = "Toy"},
    
    ["The Puppet"] = {Path = {"Animatronics", "Puppet", "PuppetNPC"}, Color = Color3.new(0, 0, 0), Type = "Other"},
    Mangle = {Path = {"Animatronics", "Mangle", "MangleNPC"}, Color = Color3.new(0.7, 0.2, 0.5), Type = "Other"},
    ["Balloon Boy"] = {Path = {"Animatronics", "BalloonBoy", "BalloonBoyNPC"}, Color = Color3.new(0.1, 0.8, 0.8), Type = "Other"},
    
    Springtrap = {Path = {"Animatronics", "Springtrap", "SpringtrapNPC"}, Color = Color3.new(0.1, 0.1, 0.05), Type = "FNAF3"},
    
    ["Nightmare Bonnie"] = {Path = {"Animatronics", "Bonnie", "BonnieNPC"}, Color = Color3.fromRGB(0, 0, 255), Type = "FNAF4"},
    ["Nightmare Chica"] = {Path = {"Animatronics", "Chica", "ChicaNPC"}, Color = Color3.fromRGB(255, 255, 0), Type = "FNAF4"},
    ["Nightmare Foxy"] = {Path = {"Animatronics", "Foxy", "FoxyNPC"}, Color = Color3.fromRGB(255, 0, 0), Type = "FNAF4"},
    ["Nightmare Fredbear"] = {Path = {"Animatronics", "Fredbear", "FredbearNPC"}, Color = Color3.fromRGB(255, 165, 0), Type = "FNAF4"},
    
    Ballora = {Path = {"Animatronics", "BalloraNPC", "BalloraNPC", "Ballora"}, Color = Color3.new(0.6, 0, 1), Type = "FNAF5"},
    ["Foxy (SL)"] = {Path = {"FoxyNight1", "Foxy"}, Color = Color3.new(1, 0.2, 0.8), Type = "FNAF5"}
}

local Window = Library:Window("FNAF COOP ESP")

local Tabs = {
    FNAF1 = Window:Tab("FNAF 1"),
    FNAF2 = Window:Tab("FNAF 2"), 
    FNAF3 = Window:Tab("FNAF 3"),
    FNAF4 = Window:Tab("FNAF 4"),
    FNAF5 = Window:Tab("FNAF 5"),
    Misc = Window:Tab("MISC")
}

local function GetModel(path)
    local current = Workspace
    for _, name in ipairs(path) do
        current = current:FindFirstChild(name)
        if not current then return nil end
    end
    return current
end

local function CreateHighlight(model, color)
    local highlight = Instance.new("Highlight")
    highlight.OutlineColor = color
    highlight.FillColor = color
    highlight.FillTransparency = 0.8
    highlight.OutlineTransparency = 0
    highlight.Adornee = model
    highlight.Parent = model
    return highlight
end

local function CreateNameTag(model, name, color)
    local root = model.PrimaryPart or model:FindFirstChild("HumanoidRootPart") or model
    
    local billboard = Instance.new("BillboardGui")
    billboard.Size = UDim2.new(0, 100, 0, 20)
    billboard.StudsOffset = Vector3.new(0, 3.5, 0)
    billboard.Adornee = root
    billboard.AlwaysOnTop = true
    billboard.Name = "ESPTag"
    
    local label = Instance.new("TextLabel")
    label.Text = name
    label.TextColor3 = color
    label.TextSize = 12
    label.Font = Enum.Font.SourceSansBold
    label.BackgroundTransparency = 1
    label.Size = UDim2.new(1, 0, 1, 0)
    label.Parent = billboard
    
    billboard.Parent = root
    return billboard
end

local function ToggleESP(name, config, enable, espType)
    local store = espType == "Highlight" and ESPStore.Highlights or ESPStore.NameTags
    
    if enable then
        if store[name] then return end
        
        local model = GetModel(config.Path)
        if not model then return end
        
        local espObject
        if espType == "Highlight" then
            espObject = CreateHighlight(model, config.Color)
        else
            espObject = CreateNameTag(model, name, config.Color)
        end
        
        store[name] = espObject
        ESPStore.Enabled[name] = ESPStore.Enabled[name] or {}
        ESPStore.Enabled[name][espType] = true
        
    else
        if store[name] then
            store[name]:Destroy()
            store[name] = nil
            if ESPStore.Enabled[name] then
                ESPStore.Enabled[name][espType] = nil
                if next(ESPStore.Enabled[name]) == nil then
                    ESPStore.Enabled[name] = nil
                end
            end
        end
    end
end

local function ClearAllESP()
    for _, highlight in pairs(ESPStore.Highlights) do
        highlight:Destroy()
    end
    for _, nameTag in pairs(ESPStore.NameTags) do
        nameTag:Destroy()
    end
    
    ESPStore.Highlights = {}
    ESPStore.NameTags = {}
end

local function RefreshESP()
    local savedState = {}
    for name, types in pairs(ESPStore.Enabled) do
        savedState[name] = types
    end
    
    ClearAllESP()
    task.wait(0.3)
    
    for name, types in pairs(savedState) do
        local config = FNAF_ESP_CONFIG[name]
        if config then
            for espType in pairs(types) do
                ToggleESP(name, config, true, espType)
                task.wait(0.05)
            end
        end
    end
end

local function CreateToggleGroup(tab, title, filter)
    tab:Label(title)
    
    for name, config in pairs(FNAF_ESP_CONFIG) do
        if config.Type == filter then
            tab:Toggle(name .. " Highlight", false, function(state)
                ToggleESP(name, config, state, "Highlight")
            end)
            
            tab:Toggle(name .. " Name Tag", false, function(state)
                ToggleESP(name, config, state, "NameTag")
            end)
        end
    end
end

CreateToggleGroup(Tabs.FNAF1, "FNAF 1 Animatronics", "FNAF1")

Tabs.FNAF2:Label("Withered Animatronics")
CreateToggleGroup(Tabs.FNAF2, "", "Withered")

Tabs.FNAF2:Label("Toy Animatronics")
CreateToggleGroup(Tabs.FNAF2, "", "Toy")

Tabs.FNAF2:Label("Other Animatronics")
CreateToggleGroup(Tabs.FNAF2, "", "Other")

Tabs.FNAF3:Label("Springtrap")
Tabs.FNAF3:Toggle("Springtrap Highlight", false, function(state)
    ToggleESP("Springtrap", FNAF_ESP_CONFIG.Springtrap, state, "Highlight")
end)
Tabs.FNAF3:Toggle("Springtrap Name Tag", false, function(state)
    ToggleESP("Springtrap", FNAF_ESP_CONFIG.Springtrap, state, "NameTag")
end)

CreateToggleGroup(Tabs.FNAF4, "Nightmare Animatronics", "FNAF4")

CreateToggleGroup(Tabs.FNAF5, "Sister Location", "FNAF5")

Tabs.Misc:Label("Utilities")
Tabs.Misc:Button("Refresh All ESP", function()
    RefreshESP()
end)
Tabs.Misc:Button("Clear All ESP", function()
    ClearAllESP()
end)

task.spawn(function()
    for name, config in pairs(FNAF_ESP_CONFIG) do
        config.Model = GetModel(config.Path)
    end
end)
